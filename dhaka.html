<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DISTRICT LEGACY MAP</title> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --b-bg: #0B0E11; --b-card: #1E2329; --b-yellow: #FCD535; --wa-green: #25D366; }
        body { background: var(--b-bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; touch-action: none; }
        
        /* Header */
        .top-nav { background: var(--b-card); padding: 10px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--b-yellow); }
        .search-box { display: flex; background: #000; border: 1px solid #444; border-radius: 5px; }
        .search-box input { background: transparent; border: none; padding: 8px; color: #fff; width: 60px; outline: none; }
        .search-box button { background: var(--b-yellow); border: none; padding: 0 12px; color: #000; cursor: pointer; }
        .dl-btn { background: #3498db; color: #fff; padding: 8px 15px; border-radius: 5px; font-weight: bold; border: none; cursor: pointer; font-size: 12px; }

        /* Square Canvas Frame */
        .map-frame { 
            width: 95vw; 
            height: 95vw; 
            max-width: 500px; 
            max-height: 500px; 
            margin: 20px auto; 
            border: 4px solid #333; 
            background: #222; 
            position: relative; 
            overflow: hidden; 
            border-radius: 10px;
        }
        #mapContainer { position: absolute; transform-origin: 0 0; cursor: grab; }
        #mapContainer:active { cursor: grabbing; }
        canvas { background: #fff; display: block; image-rendering: pixelated; }
        #plotMarker { position: absolute; border: 3px solid #ff0000; pointer-events: none; display: none; background: rgba(255,0,0,0.3); z-index: 10; box-sizing: border-box; }

        /* Support Button */
        .wa-float { position: fixed; bottom: 20px; right: 20px; background: var(--wa-green); padding: 10px 20px; border-radius: 50px; display: flex; align-items: center; gap: 8px; color: #fff; text-decoration: none; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.4); cursor: pointer; border: 2px solid #fff; z-index: 1000; }

        /* Support Dashboard Overlay */
        .dashboard { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; padding: 20px; box-sizing: border-box; }
        .db-card { background: var(--b-card); padding: 25px; border-radius: 15px; border: 2px solid var(--b-yellow); width: 100%; max-width: 350px; text-align: left; }
        .db-card h2 { color: var(--b-yellow); margin-top: 0; text-align: center; }
        .db-list { list-style: none; padding: 0; font-size: 14px; line-height: 2; color: #ccc; }
        .db-list b { color: #fff; }
        .db-btns { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .contact-btn { background: var(--wa-green); color: #fff; padding: 12px; border-radius: 8px; text-align: center; text-decoration: none; font-weight: bold; }
        .back-btn { background: #444; color: #fff; padding: 10px; border-radius: 8px; text-align: center; cursor: pointer; font-size: 13px; }
    </style>
</head>
<body>

<div class="top-nav">
    <div class="search-box">
        <input type="number" id="plotInput" placeholder="ID">
        <button onclick="locatePlot()"><i class="fas fa-search"></i></button>
    </div>
    <button class="dl-btn" onclick="downloadMap()"><i class="fas fa-download"></i> MAP IMAGE</button>
</div>

<div class="map-frame" id="viewport">
    <div id="mapContainer">
        <div id="plotMarker"></div>
        <canvas id="mapCanvas"></canvas>
    </div>
</div>

<div class="wa-float" onclick="openDashboard()">
    <i class="fab fa-whatsapp"></i> CUSTOMER SUPPORT
</div>

<div class="dashboard" id="dbOverlay">
    <div class="db-card">
        <h2>Creator Support</h2>
        <ul class="db-list">
            <li>1. <b>Payment Proof:</b> Screenshot of ৳24.</li>
            <li>2. <b>Plot Details:</b> Brand Name & Plot ID.</li>
            <li>3. <b>Brand Logo:</b> Send your square logo.</li>
            <li>4. <b>Official Link:</b> Website/Social link.</li>
        </ul>
        <div class="db-btns">
            <a href="https://wa.me/8801756206213" target="_blank" class="contact-btn">CONTACT CUSTOMER SUPPORT</a>
            <div class="back-btn" onclick="closeDashboard()">BACK TO MAP</div>
        </div>
    </div>
</div>

<script>
    const totalPlots = 2400;
    const cols = 60; // ৬০ কলাম
    const bS = 60; // ৬০ পিক্সেল সাইজ
    const canvas = document.getElementById('mapCanvas');
    const ctx = canvas.getContext('2d');
    const container = document.getElementById('mapContainer');
    const viewport = document.getElementById('viewport');
    const marker = document.getElementById('plotMarker');

    canvas.width = cols * bS; 
    canvas.height = (totalPlots / cols) * bS; // ৪০ সারি

    let scale = 0.2;
    let posX = 0, posY = 0;

    function drawMap() {
        ctx.fillStyle = "#fff";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = "#ddd";
        ctx.font = "14px Arial";
        ctx.textAlign = "center";
        
        for (let i = 1; i <= totalPlots; i++) {
            const r = Math.floor((i - 1) / cols);
            const c = (i - 1) % cols;
            const x = c * bS;
            const y = r * bS;
            ctx.strokeRect(x, y, bS, bS);
            ctx.fillStyle = "#888";
            ctx.fillText(i, x + bS/2, y + bS/2 + 6);
        }
    }

    // প্যান এবং ড্র্যাগ লজিক
    let isDragging = false;
    let startX, startY;

    function handleStart(e) {
        isDragging = true;
        const touch = e.touches ? e.touches[0] : e;
        startX = touch.clientX - posX;
        startY = touch.clientY - posY;
    }
    function handleMove(e) {
        if (!isDragging) return;
        const touch = e.touches ? e.touches[0] : e;
        posX = touch.clientX - startX;
        posY = touch.clientY - startY;
        updateTransform();
    }
    function handleEnd() { isDragging = false; }

    viewport.addEventListener('mousedown', handleStart);
    window.addEventListener('mousemove', handleMove);
    window.addEventListener('mouseup', handleEnd);
    viewport.addEventListener('touchstart', handleStart);
    viewport.addEventListener('touchmove', handleMove);
    viewport.addEventListener('touchend', handleEnd);

    // জুম লজিক
    viewport.addEventListener('wheel', (e) => {
        e.preventDefault();
        scale -= e.deltaY * 0.001;
        scale = Math.min(Math.max(0.05, scale), 1.5);
        updateTransform();
    }, { passive: false });

    function updateTransform() {
        container.style.transform = `translate(${posX}px, ${posY}px) scale(${scale})`;
    }

    function locatePlot() {
        const id = parseInt(document.getElementById('plotInput').value);
        if (id < 1 || id > 2400) return;
        const r = Math.floor((id-1)/cols), c = (id-1)%cols;
        const tx = c * bS, ty = r * bS;
        marker.style.display = 'block';
        marker.style.width = bS + "px"; marker.style.height = bS + "px";
        marker.style.left = tx + "px"; marker.style.top = ty + "px";
        scale = 1;
        posX = (viewport.offsetWidth/2) - (tx * scale) - (bS/2);
        posY = (viewport.offsetHeight/2) - (ty * scale) - (bS/2);
        updateTransform();
    }

    // ড্যাশবোর্ড লজিক
    function openDashboard() { document.getElementById('dbOverlay').style.display = 'flex'; }
    function closeDashboard() { document.getElementById('dbOverlay').style.display = 'none'; }
    function downloadMap() {
        const link = document.createElement('a');
        link.download = 'map.png'; link.href = canvas.toDataURL(); link.click();
    }

    window.onload = () => { drawMap(); updateTransform(); };
</script>

</body>
</html>
